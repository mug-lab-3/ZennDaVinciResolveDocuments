---
title: ã€DaVinci Resolveã€‘ å›è»¢ã—ãŸå››è§’å½¢ã®è¨ˆç®—ã€Fusionã€‘"
emoji: "ğŸ“"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["davinciresolve"]
published: true
---

# ğŸ¥ ã¯ã˜ã‚ã«

ã¿ãªã•ã‚“ã€ã“ã‚“ã«ã¡ã¯ã€‚[Mug](https://www.youtube.com/@MugLabVideoEditing)ã§ã™ âœ¨

ã“ã‚Œã¯ ğŸ“½[DaVinci Resolve](https://www.blackmagicdesign.com/jp/products/davinciresolve)ã«ã¤ã„ã¦ã®è¨˜äº‹ã§ã™ã€‚
DaVinci Resolve ã® Fusion ã§ã¯ã€ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã®å€¤ã¨ã—ã¦`Expression`ã‚’è¨­å®šã™ã‚‹ã“ã¨ãŒå‡ºæ¥ã¾ã™ãŒ
ãã“ã«å…¥åŠ›ã™ã‚‹è¨ˆç®—å¼ã§ã€å››è§’å½¢ã®è¨ˆç®—æ–¹æ³•ã«ã¤ã„ã¦ã®è¨˜äº‹ã§ã™ã€‚

![Context Menu](/images/articles/expression/context-menu.png)
_Expression è¨­å®šãƒ¡ãƒ‹ãƒ¥ãƒ¼(å³ã‚¯ãƒªãƒƒã‚¯)_

![Expression Sample](/images/articles/expression/expression-sample.png)
_ã“ã“ã«å…¥åŠ›ã™ã‚‹è¨ˆç®—å¼ã®è©±_

![Width/Height](/images/articles/rotation-size/result.png)
ğŸ‘† ã‚„ã‚ŠãŸã„ã®ã¯ã“ã¡ã‚‰ã€é»„è‰²ã„å››è§’å½¢ã‚’åã‚ã‚‹é’ã„å››è§’å½¢ã®å¹…ãƒ»é«˜ã•ã®è¨ˆç®—æ–¹æ³•

Expression ã®åŸºæœ¬çš„ã¯è¨ˆç®—ã¯ ğŸ‘‡ ã“ã£ã¡ã‚’è¦‹ã¦ã­ ğŸ¼
https://zenn.dev/muglab3/articles/1d32711f7eb419

:::message
ğŸ“½DaVinci Resolve 19.1.3 ã§ç¢ºèªã—ã¦ã„ã¾ã™ã€‚
:::

# å›è»¢ã—ã¦ã„ã‚‹å››è§’å½¢ã®å¹…ãƒ»é«˜ã•ã‚’è¨ˆç®—ã™ã‚‹

å››è§’å½¢ã‚’å›è»¢ã•ã›ãŸã¨ãã® X è»¸æ–¹å‘ã®é•·ã•ã€Y è»¸æ–¹å‘ã®é«˜ã•ã¯
ğŸ« å­¦æ ¡ã§ç¿’ã†ã‚ˆã†ã« ğŸ“ ä¸‰è§’é–¢æ•°ã§è¨ˆç®—ã§ãã¾ã™ãŒ
DaVinci Resolve ã§ã¯ã„ãã¤ã‹æ³¨æ„ç‚¹ãŒã‚ã‚Šã¾ã™ â—

## ä¸‰è§’é–¢æ•°ã«æ¸¡ã™è§’åº¦ã¯ radian

Expression ã§ã¯ `sin`, `cos`, `tan` ã¨ã„ã†é–¢æ•°ãŒä½¿ãˆã¾ã™ãŒã€ã“ã®é–¢æ•°ãŒå—ã‘å–ã‚‹è§’åº¦ã¯ radian ã§ã™
ã—ã‹ã—ã€ã‚¤ãƒ³ã‚¹ãƒšã‚¯ã‚¿ã®ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã«å…¥åŠ›ã™ã‚‹å€¤ã¯åŸºæœ¬çš„ã« degree ã§ã™
ãªã®ã§ã¾ãšã¯ degree ã‹ã‚‰ radian ã«å¤‰æ›ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ ğŸ¤”
ãã®æ™‚ä½¿ç”¨ã™ã‚‹é–¢æ•°ãŒ`rad`ã§ã™

### 60Â° ã‚’ radian ã«å¤‰æ›ã™ã‚‹

```lua
rad(60)
```

ğŸ‘‰ 1.047

### ã‚µã‚¤ãƒ³ã€ã‚³ã‚µã‚¤ãƒ³ã€ã‚¿ãƒ³ã‚¸ã‚§ãƒ³ãƒˆ ğŸ’ƒ

```lua
sin(rad(60))
```

ğŸ‘‰ 0.866

```lua
cos(rad(60))
```

ğŸ‘‰ 0.500

```lua
tan(rad(60))
```

ğŸ‘‰ 1.732

## ã‚¢ã‚¹ãƒšã‚¯ãƒˆæ¯”ã‚’è€ƒæ…®ã™ã‚‹

DaVinci Resolve ã§ã¯åŸºæœ¬çš„ã«åº§æ¨™ã¯å…¨ä½“ã‚’ 1.0 ã¨ã—ãŸç›¸å¯¾åº§æ¨™ã¨ãªã£ã¦ã„ã¾ã™
ã“ã‚Œã¯ç¸¦ãƒ»æ¨ªã©ã¡ã‚‰ã‚‚åŒã˜ã§ã™
ãã®ãŸã‚ã‚¢ã‚¹ãƒšã‚¯ãƒˆæ¯”ãŒ 1:1 ã§ã¯ãªã„å ´åˆã€åŒã˜å€¤ã§ã‚‚çµ¶å¯¾çš„ãªå¤§ãã•ã¯ç¸¦ã¨æ¨ªã§ç•°ãªã‚Šã¾ã™
ã“ã‚ŒãŒ`Expression`ã§ã‚µã‚¤ã‚ºè¨ˆç®—ã‚’è¡Œã†ä¸Šã§é‡è¦ãªãƒã‚¤ãƒ³ãƒˆã¨ãªã‚Šã¾ã™ ğŸ˜¤

ğŸ‘‡ ç¸¦ã¨æ¨ªã¨ã‚‚ã« 0.5 ã‚’è¨­å®šã—ã¦ã‚‚æ­£æ–¹å½¢ã«ã¯ãªã‚‰ãªã„ ğŸ˜®
![Width/Height](/images/articles/rotation-size/aspect-ratio.png)

### ã‚¢ã‚¹ãƒšã‚¯ãƒˆæ¯”è¨ˆç®—

ã¾ãšã¯ã‚¢ã‚¹ãƒšã‚¯ãƒˆæ¯”ã‚’çŸ¥ã‚‹ã¨ã“ã‚ã‹ã‚‰
ã“ã‚Œã«ã¯`comp:GetPrefs`ã‚’ç”¨ã„ã¦`Comp.FrameFormat.Width`ã¨`Comp.FrameFormat.Height`ã‹ã‚‰ç¸¦æ¨ªã‚µã‚¤ã‚ºã‚’å–å¾—ã—ã¦è¨ˆç®—ã—ã¾ã™

:::message
ã“ã‚Œã¯ã‚‚ã†ã¡ã‚‡ã£ã¨ã„ã„æ–¹æ³•ãŒã‚ã‚‹ã‹ã‚‚ã§ã™ ğŸ˜­
:::

#### 1920x1080 ã§ä½œã£ã¦ã„ã‚‹å ´åˆ

```lua
comp:GetPrefs("Comp.FrameFormat.Width")
```

ğŸ‘‰ 1920

```lua
comp:GetPrefs("Comp.FrameFormat.Height")
```

ğŸ‘‰ 1080

```lua
comp:GetPrefs("Comp.FrameFormat.Width") / comp:GetPrefs("Comp.FrameFormat.Height")
```

ğŸ‘‰ 1.777

ã“ã‚Œã‚’é«˜ã•å´ã«ã‹ã‘åˆã‚ã›ã‚‹ã¨

```lua
0.5 * (comp:GetPrefs("Comp.FrameFormat.Width") / comp:GetPrefs("Comp.FrameFormat.Height"))
```

![Width/Height](/images/articles/rotation-size/square.png)
æ­£æ–¹å½¢ã«ãªã‚Šã¾ã™ ğŸ‘

### ã‚¢ã‚¹ãƒšã‚¯ãƒˆæ¯”è¨ˆç®—çµæœã‚’è¦šãˆã¦ãŠã

ã‚¢ã‚¹ãƒšã‚¯ãƒˆæ¯”ã¯ã‚µã‚¤ã‚ºã®è¨ˆç®—ã§ã¯é »ç¹ã«å‡ºã¦ãã¾ã™
ãã‚Œã‚’ ğŸ‘† ã®ã‚ˆã†ãªé•·ã„å¼ã‚’å…¥ã‚Œã¦ã„ã‚‹ã¨å¤§å¤‰ ğŸ˜µâ€ğŸ’« ãªã®ã§ã€è¨ˆç®—çµæœã‚’è¦šãˆã¦ãŠã„ã¦ç°¡å˜ã«ä½¿ãˆã‚‹ã‚ˆã†ã«ã—ã¾ã™

ãã‚Œã«ã¯`self:SetData`, `self:GetData`ã‚’ä½¿ç”¨ã—ã¾ã™

#### SetData

self:SetData("`åˆè¨€è‘‰`", `è¦šãˆã¦ãŠãå€¤`) ã§ã™

```lua
self:SetData("aspectRatio", (comp:GetPrefs("Comp.FrameFormat.Width") / comp:GetPrefs("Comp.FrameFormat.Height")))
```

#### GetData

self:SetData("`åˆè¨€è‘‰`") ã§ã™

```lua
self:GetData("aspectRatio")
```

ğŸ‘‰ 1.777

#### Start Render Script

ã§ã¯ã©ã“ã§`self:SetData`ã™ã‚Œã°ã„ã„ã®ï¼Ÿã¨ã„ã†ã¨
`è¨ˆç®—å¼ã‚’ã„ã‚Œã‚‹äºˆå®šã®ãƒãƒ¼ãƒ‰`ã®`Start Render Script`ã§ã™

`Start Render Script`ã§ã¯ rendering é–‹å§‹æ™‚ã«å®Ÿè¡Œã—ãŸã„å‡¦ç†ã‚’æ›¸ãã¨ã“ã‚ãªã®ã§
ã“ã“ã§ã‚¢ã‚¹ãƒšã‚¯ãƒˆæ¯”ã‚’è¦šãˆã¦ãŠãã‚ˆã†ã«ã—ã¾ã™ ğŸ˜¤

![Width/Height](/images/articles/rotation-size/start-render-script.png)

## ğŸ‘¾ å®Ÿè·µ ğŸ‘¾

ã“ã“ã¾ã§ã®å†…å®¹ã‚’ä½¿ã£ã¦
å››è§’å½¢ã‚’ãƒ”ãƒƒã‚¿ãƒªåã‚ã‚‹ã‚ˆã†ãªå›è»¢ã—ãŸå››è§’å½¢ã®å¹…ã¨é«˜ã•ã‚’è¨ˆç®—ã—ã¾ã™

![Width/Height](/images/articles/rotation-size/result.png)
ğŸ‘† ã‚„ã‚ŠãŸã„ã®ã¯ã“ã¡ã‚‰

é»„è‰²ã®å››è§’å½¢: Rectangle1
é’è‰²ã®å››è§’å½¢: Rectangle2

### å¹…

2 ã¤ã®éƒ¨åˆ†ã«åˆ†ã‘ã¦è€ƒãˆã¦ã€ãã‚Œã‚‰ã‚’è¶³ã—ã¦`å¹…`ã¨ã—ã¾ã™
å¹…ã‚’æ±‚ã‚ãŸã„ã®ã§ä¸‰è§’é–¢æ•°ã®ãƒã‚¤ãƒŠã‚¹å€¤å´ã¯ã„ã‚‰ãªã„ã§ã™ã€`abs`ã‚’ä½¿ã£ã¦çµ¶å¯¾å€¤ã«å¤‰æ›ã—ã¾ã™

#### ç´«ã®ç›´è§’ä¸‰è§’å½¢ã‹ã‚‰åº•è¾ºéƒ¨åˆ†(ç·‘)

![width*cos](/images/articles/rotation-size/wcos.png)

```lua
Rectangle1.Width * abs(cos(rad(Angle)))
```

#### ç´«ã®ç›´è§’ä¸‰è§’å½¢ã‹ã‚‰é«˜ã•éƒ¨åˆ†(ç·‘)

![width*cos](/images/articles/rotation-size/hsin.png)

```lua
Rectangle1.Height * abs(sin(rad(Angle))) * (1 / self:GetData("aspectRatio"))
```

ã“ã¡ã‚‰ã¯`Rectangle1.Height`ã‚’ã‚‚ã¨ã«è¨ˆç®—ã™ã‚‹ã®ã§ã€`ã‚¢ã‚¹ãƒšã‚¯ãƒˆæ¯”: self:GetData("aspectRatio")`ã®é€†æ•°ã‚’ã‹ã‘ã¾ã™

#### çµæœ

ã“ã‚Œã‚‰ã‚’è¶³ã—ã¦ã€å¹…ã‚’æ±‚ã‚ã‚‹å¼ã¯ ğŸ‘‡ ã“ã¡ã‚‰ã§ã™ ğŸ˜¤

```lua
(Rectangle1.Width * abs(cos(rad(Angle)))) + (Rectangle1.Height * abs(sin(rad(Angle))) * (1 / self:GetData("aspectRatio")))
```

### é«˜ã•

`é«˜ã•`ã‚‚å¹…ã¨åŒæ§˜ã«ã€2 ã¤ã®éƒ¨åˆ†ã«åˆ†ã‘ã¦è€ƒãˆã¦ã€ãã‚Œã‚‰ã‚’è¶³ã—ã¦`é«˜ã•`ã¨ã—ã¾ã™
`é«˜ã•`ã®å ´åˆã¯å‰è¿°ã®ã‚ˆã†ã«ã‚¢ã‚¹ãƒšã‚¯ãƒˆæ¯”ã‚’è€ƒæ…®ã—ã¦`ã‚¢ã‚¹ãƒšã‚¯ãƒˆæ¯”: self:GetData("aspectRatio")`ã‚’ã‹ã‘ã¾ã™

#### ç´«ã®ç›´è§’ä¸‰è§’å½¢ã‹ã‚‰é«˜ã•éƒ¨åˆ†(ç·‘)

![width*cos](/images/articles/rotation-size/wsin.png)

```lua
Rectangle1.Width * abs(sin(rad(Angle))) * self:GetData("aspectRatio")
```

#### ç´«ã®ç›´è§’ä¸‰è§’å½¢ã‹ã‚‰åº•è¾ºéƒ¨åˆ†(ç·‘)

![width*cos](/images/articles/rotation-size/hcos.png)

```lua
Rectangle1.Height * abs(cos(rad(Angle))) * (1 / self:GetData("aspectRatio")) * self:GetData("aspectRatio")
```

ã“ã¡ã‚‰ã¯`Rectangle1.Height`ã‚’ã‚‚ã¨ã«è¨ˆç®—ã™ã‚‹ã®ã§ã€`ã‚¢ã‚¹ãƒšã‚¯ãƒˆæ¯”: self:GetData("aspectRatio")`ã®é€†æ•°ã‚’ã‹ã‘ã¾ã™
:::message
ã“ã¡ã‚‰ã‚‚ã‚¢ã‚¹ãƒšã‚¯ãƒˆæ¯”ã‚’ã‹ã‘ã‚‹ã®ã§çµæœçš„ã«æ‰“ã¡æ¶ˆã•ã‚Œã¾ã™
:::

#### çµæœ

ã“ã‚Œã‚‰ã‚’è¶³ã—ã¦ã€`é«˜ã•`ã‚’æ±‚ã‚ã‚‹å¼ã¯ ğŸ‘‡ ã“ã¡ã‚‰ã§ã™ ğŸ˜¤

```lua
((Rectangle1.Width * abs(sin(rad(Angle)))) + (Rectangle1.Height * abs(cos(rad(Angle))) * (1 / self:GetData("aspectRatio")))) * self:GetData("aspectRatio")
```

# ğŸ” ãŠã‚ã‚Šã«

ã¡ã‚‡ã£ã¨ã‚€ãšã‹ã—ã„ã­ï¼ğŸ¼
